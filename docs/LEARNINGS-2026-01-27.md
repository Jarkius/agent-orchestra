# Learnings

_Auto-generated: 2026-01-27T05:41:07.919Z_

**Total:** 58 learnings across 8 categories

---

# Architecture

## Lesson: getLastInsertRowId function didnt exist - needed result.lastInsertRowid pattern
**Date**: 2026-01-22
**Category**: Architecture
**Confidence**: [low]

### What happened
Challenge from session: getLastInsertRowId function didnt exist - needed result.lastInsertRowid pattern

### What I learned
getLastInsertRowId function didnt exist - needed result.lastInsertRowid pattern

### How to prevent
N/A

---

## Lesson: Challenge: getLastInsertRowId function didnt exist - needed result.lastInsertRowid pattern
**Date**: 2026-01-22
**Category**: Architecture
**Confidence**: [low]

### What happened
getLastInsertRowId function didnt exist - needed result.lastInsertRowid pattern

### What I learned
Challenge: getLastInsertRowId function didnt exist - needed result.lastInsertRowid pattern

### How to prevent
N/A

---

# Performance

## Lesson: Always set TTL to prevent memory leaks
**Date**: 2026-01-23
**Category**: Performance
**Confidence**: [low]

### What happened
N/A

### What I learned
Always set TTL to prevent memory leaks

### How to prevent
N/A

---

## Lesson: set TTL to prevent memory leaks
**Date**: 2026-01-23
**Category**: Performance
**Confidence**: [low]

### What happened
N/A

### What I learned
set TTL to prevent memory leaks

### How to prevent
N/A

---

## Lesson: Always set TTL to prevent memory leaks
**Date**: 2026-01-23
**Category**: Performance
**Confidence**: [low]

### What happened
N/A

### What I learned
Always set TTL to prevent memory leaks

### How to prevent
N/A

---

## Lesson: set TTL to prevent memory leaks
**Date**: 2026-01-23
**Category**: Performance
**Confidence**: [low]

### What happened
N/A

### What I learned
set TTL to prevent memory leaks

### How to prevent
N/A

---

## Lesson: Always set TTL to prevent memory leaks
**Date**: 2026-01-23
**Category**: Performance
**Confidence**: [low]

### What happened
N/A

### What I learned
Always set TTL to prevent memory leaks

### How to prevent
N/A

---

## Lesson: set TTL to prevent memory leaks
**Date**: 2026-01-23
**Category**: Performance
**Confidence**: [low]

### What happened
N/A

### What I learned
set TTL to prevent memory leaks

### How to prevent
N/A

---

# Tooling

## Lesson: Merged code from other matrix overwrote local matrix_id config
**Date**: 2026-01-24
**Category**: Tooling
**Confidence**: [medium] (2x)

### What happened
Challenge from session: Merged code from other matrix overwrote local matrix_id config

### What I learned
Merged code from other matrix overwrote local matrix_id config

### How to prevent
N/A

---

## Lesson: Made .matrix.json local-only to prevent cross-project config conflicts
**Date**: 2026-01-24
**Category**: Tooling
**Confidence**: [medium] (2x)

### What happened
Win from session: Made .matrix.json local-only to prevent cross-project config conflicts

### What I learned
Made .matrix.json local-only to prevent cross-project config conflicts

### How to prevent
N/A

---

## Lesson: Multi-repo GitHub sync uses gh CLI -R owner/repo flag for targeting different repos
**Date**: 2026-01-22
**Category**: Tooling
**Confidence**: [medium]

### What happened
N/A

### What I learned
Multi-repo GitHub sync uses gh CLI -R owner/repo flag for targeting different repos

### How to prevent
N/A

---

## Lesson: Made .matrix.json local-only to prevent cross-project config conflicts
**Date**: 2026-01-26
**Category**: Tooling
**Confidence**: [low]

### What happened
Win from session: Made .matrix.json local-only to prevent cross-project config conflicts

### What I learned
Made .matrix.json local-only to prevent cross-project config conflicts

### How to prevent
N/A

---

## Lesson: Merged code from other matrix overwrote local matrix_id config
**Date**: 2026-01-26
**Category**: Tooling
**Confidence**: [low]

### What happened
Challenge from session: Merged code from other matrix overwrote local matrix_id config

### What I learned
Merged code from other matrix overwrote local matrix_id config

### How to prevent
N/A

---

## Lesson: Challenge: Merged code from other matrix overwrote local matrix_id config
**Date**: 2026-01-24
**Category**: Tooling
**Confidence**: [low]

### What happened
Merged code from other matrix overwrote local matrix_id config

### What I learned
Challenge: Merged code from other matrix overwrote local matrix_id config

### How to prevent
N/A

---

## Lesson: Multi-repo GitHub sync uses gh CLI -R owner/repo flag for targeting different repos
**Date**: 2026-01-22
**Category**: Tooling
**Confidence**: [low]

### What happened
Learning from session: Multi-repo GitHub sync uses gh CLI -R owner/repo flag for targeting different repos

### What I learned
Multi-repo GitHub sync uses gh CLI -R owner/repo flag for targeting different repos

### How to prevent
N/A

---

# Debugging

## Lesson: Challenge: Hub PIN required after daemon restart - restarted hub with PIN disabled
**Date**: 2026-01-23
**Category**: Debugging
**Confidence**: [low]

### What happened
Hub PIN required after daemon restart - restarted hub with PIN disabled

### What I learned
Challenge: Hub PIN required after daemon restart - restarted hub with PIN disabled

### How to prevent
N/A

---

## Lesson: Challenge: Direct hub connection bypassing daemon didn't have PIN
**Date**: 2026-01-23
**Category**: Debugging
**Confidence**: [low]

### What happened
Direct hub connection bypassing daemon didn't have PIN

### What I learned
Challenge: Direct hub connection bypassing daemon didn't have PIN

### How to prevent
N/A

---

## Lesson: Challenge: Concurrent git pushes required multiple rebase cycles
**Date**: 2026-01-23
**Category**: Debugging
**Confidence**: [low]

### What happened
Concurrent git pushes required multiple rebase cycles

### What I learned
Challenge: Concurrent git pushes required multiple rebase cycles

### How to prevent
N/A

---

## Lesson: Challenge: saveMatrixMessage return type needed to change to include sequenceNumber
**Date**: 2026-01-22
**Category**: Debugging
**Confidence**: [low]

### What happened
saveMatrixMessage return type needed to change to include sequenceNumber

### What I learned
Challenge: saveMatrixMessage return type needed to change to include sequenceNumber

### How to prevent
N/A

---

# Process

## Lesson: Resume: Test matrix hub and daemon
**Date**: 2026-01-23
**Category**: Process
**Confidence**: [low]

### What happened
Next session should test matrix hub/daemon communication between matrices. Key commits: 65fa15d (CHECK constraint), d3c3a8a (matrix_id from config), 0e623b4 (per-matrix PID files), 502c324 (hub ping handling). All 42 unit tests pass but need live multi-matrix testing.

### What I learned
Resume: Test matrix hub and daemon

### How to prevent
N/A

---

# Security

## Lesson: Token grace periods (30s) prevent auth failures during reconnection attempts
**Date**: 2026-01-24
**Category**: Security
**Confidence**: [medium] (2x)

### What happened
Learning from session: Token grace periods (30s) prevent auth failures during reconnection attempts

### What I learned
Token grace periods (30s) prevent auth failures during reconnection attempts

### How to prevent
N/A

---

## Lesson: Token grace periods (30s) prevent auth failures during reconnection attempts
**Date**: 2026-01-24
**Category**: Security
**Confidence**: [medium] (2x)

### What happened
N/A

### What I learned
Token grace periods (30s) prevent auth failures during reconnection attempts

### How to prevent
N/A

---

## Lesson: Token grace periods (30s) prevent auth failures during reconnection attempts
**Date**: 2026-01-26
**Category**: Security
**Confidence**: [low]

### What happened
Learning from session: Token grace periods (30s) prevent auth failures during reconnection attempts

### What I learned
Token grace periods (30s) prevent auth failures during reconnection attempts

### How to prevent
N/A

---

# Testing

## Lesson: Hub readiness should be verified via health endpoint before tests
**Date**: 2026-01-23
**Category**: Testing
**Confidence**: [medium]

### What happened
N/A

### What I learned
Hub readiness should be verified via health endpoint before tests

### How to prevent
N/A

---

## Lesson: Hub readiness should be verified via health endpoint before running tests
**Date**: 2026-01-23
**Category**: Testing
**Confidence**: [medium]

### What happened
N/A

### What I learned
Hub readiness should be verified via health endpoint before running tests

### How to prevent
N/A

---

## Lesson: Challenge: Tests were passing but had latent timing vulnerabilities
**Date**: 2026-01-23
**Category**: Testing
**Confidence**: [low]

### What happened
Tests were passing but had latent timing vulnerabilities

### What I learned
Challenge: Tests were passing but had latent timing vulnerabilities

### How to prevent
N/A

---

## Lesson: Comprehensive Audit Testing Patterns
**Date**: 2026-01-22
**Category**: Testing
**Confidence**: [low]

### What happened
Effective patterns for system auditing discovered during task unification:

1. SCHEMA AUDIT - Check table structure with sqlite3 .schema, verify constraints and indexes
2. DATA INTEGRITY - Group by domain/status to find distribution anomalies, check for orphaned records
3. FLOW TESTS - Complete CRUD lifecycle (Create → Read → Update → Delete), verify state at each step
4. EDGE CASES - Test empty strings, very long inputs (500+ chars), unicode/emoji, special characters, boundary IDs (0, -1, non-numeric)
5. STATE TRANSITIONS - Test all valid status changes (open↔in_progress↔blocked↔done↔wont_fix), verify bidirectional
6. BACKWARDS COMPAT - Ensure old syntax still works alongside new patterns
7. CONCURRENT OPS - Run 5+ operations in parallel to catch race conditions
8. INTEGRATION - Verify cross-component interactions (e.g., recall shows unified tasks)
9. ERROR HANDLING - Test invalid inputs return proper errors, not crashes

Key insight: Running these systematically catches bugs that manual testing misses.

### What I learned
Comprehensive Audit Testing Patterns

### How to prevent
N/A

---

## Lesson: Test scripts validate concurrent init and message ordering
**Date**: 2026-01-22
**Category**: Testing
**Confidence**: [low]

### What happened
Win from session: Test scripts validate concurrent init and message ordering

### What I learned
Test scripts validate concurrent init and message ordering

### How to prevent
N/A

---

# Insight

## Lesson: Helper functions (getTaskLineage
**Date**: 2026-01-23
**Category**: Insight
**Confidence**: [medium] (2x)

### What happened
Win from session: Helper functions (getTaskLineage

### What I learned
Helper functions (getTaskLineage

### How to prevent
N/A

---

## Lesson: getSiblingTasks
**Date**: 2026-01-23
**Category**: Insight
**Confidence**: [medium] (2x)

### What happened
Win from session: getSiblingTasks

### What I learned
getSiblingTasks

### How to prevent
N/A

---

## Lesson: getLearningsByTask) work correctly
**Date**: 2026-01-23
**Category**: Insight
**Confidence**: [medium] (2x)

### What happened
Win from session: getLearningsByTask) work correctly

### What I learned
getLearningsByTask) work correctly

### How to prevent
N/A

---

## Lesson: Concurrent git pushes required multiple rebase cycles
**Date**: 2026-01-23
**Category**: Insight
**Confidence**: [medium] (2x)

### What happened
Challenge from session: Concurrent git pushes required multiple rebase cycles

### What I learned
Concurrent git pushes required multiple rebase cycles

### How to prevent
N/A

---

## Lesson: completeTask should auto-sync unified_task status when all linked tasks finish
**Date**: 2026-01-23
**Category**: Insight
**Confidence**: [medium] (2x)

### What happened
Learning from session: completeTask should auto-sync unified_task status when all linked tasks finish

### What I learned
completeTask should auto-sync unified_task status when all linked tasks finish

### How to prevent
N/A

---

## Lesson: Two-phase commit (pending→sending→sent) needs all states in DB constraint
**Date**: 2026-01-23
**Category**: Insight
**Confidence**: [medium]

### What happened
N/A

### What I learned
Two-phase commit (pending→sending→sent) needs all states in DB constraint

### How to prevent
N/A

---

## Lesson: completeTask should auto-sync unified_task status when all linked tasks finish
**Date**: 2026-01-23
**Category**: Insight
**Confidence**: [medium]

### What happened
N/A

### What I learned
completeTask should auto-sync unified_task status when all linked tasks finish

### How to prevent
N/A

---

## Lesson: Idempotent migrations should run outside conditional schema init block
**Date**: 2026-01-22
**Category**: Insight
**Confidence**: [medium]

### What happened
N/A

### What I learned
Idempotent migrations should run outside conditional schema init block

### How to prevent
N/A

---

## Lesson: Hub readiness should be verified via health endpoint before running tests
**Date**: 2026-01-26
**Category**: Insight
**Confidence**: [low]

### What happened
Learning from session: Hub readiness should be verified via health endpoint before running tests

### What I learned
Hub readiness should be verified via health endpoint before running tests

### How to prevent
N/A

---

## Lesson: Single hub instance eliminates port release race condition
**Date**: 2026-01-26
**Category**: Insight
**Confidence**: [low]

### What happened
Win from session: Single hub instance eliminates port release race condition

### What I learned
Single hub instance eliminates port release race condition

### How to prevent
N/A

---

## Lesson: Tests were passing but had latent timing vulnerabilities
**Date**: 2026-01-26
**Category**: Insight
**Confidence**: [low]

### What happened
Challenge from session: Tests were passing but had latent timing vulnerabilities

### What I learned
Tests were passing but had latent timing vulnerabilities

### How to prevent
N/A

---

## Lesson: Two-phase commit (pending→sending→sent) needs all states in DB constraint
**Date**: 2026-01-26
**Category**: Insight
**Confidence**: [low]

### What happened
Learning from session: Two-phase commit (pending→sending→sent) needs all states in DB constraint

### What I learned
Two-phase commit (pending→sending→sent) needs all states in DB constraint

### How to prevent
N/A

---

## Lesson: All 42 matrix unit tests passing
**Date**: 2026-01-26
**Category**: Insight
**Confidence**: [low]

### What happened
Win from session: All 42 matrix unit tests passing

### What I learned
All 42 matrix unit tests passing

### How to prevent
N/A

---

## Lesson: Direct hub connection bypassing daemon didn't have PIN
**Date**: 2026-01-26
**Category**: Insight
**Confidence**: [low]

### What happened
Challenge from session: Direct hub connection bypassing daemon didn't have PIN

### What I learned
Direct hub connection bypassing daemon didn't have PIN

### How to prevent
N/A

---

## Lesson: Hub readiness should be verified via health endpoint before tests
**Date**: 2026-01-26
**Category**: Insight
**Confidence**: [low]

### What happened
Learning from session: Hub readiness should be verified via health endpoint before tests

### What I learned
Hub readiness should be verified via health endpoint before tests

### How to prevent
N/A

---

## Lesson: Matrix ID now matches project name for clarity
**Date**: 2026-01-26
**Category**: Insight
**Confidence**: [low]

### What happened
Win from session: Matrix ID now matches project name for clarity

### What I learned
Matrix ID now matches project name for clarity

### How to prevent
N/A

---

## Lesson: Hub PIN required after daemon restart - restarted hub with PIN disabled
**Date**: 2026-01-26
**Category**: Insight
**Confidence**: [low]

### What happened
Challenge from session: Hub PIN required after daemon restart - restarted hub with PIN disabled

### What I learned
Hub PIN required after daemon restart - restarted hub with PIN disabled

### How to prevent
N/A

---

## Lesson: [msg:direct] [from:/Users/jarkius/workspace/test-spawns] [to:test-matrix2] Can you see this message? Reply back!
**Date**: 2026-01-23
**Category**: Insight
**Confidence**: [low]

### What happened
N/A

### What I learned
[msg:direct] [from:/Users/jarkius/workspace/test-spawns] [to:test-matrix2] Can you see this message? Reply back!

### How to prevent
N/A

---

## Lesson: [msg:direct] [from:/Users/jarkius/workspace/test-spawns] [to:test-matrix2] Connection stability test from test-spawns
**Date**: 2026-01-23
**Category**: Insight
**Confidence**: [low]

### What happened
N/A

### What I learned
[msg:direct] [from:/Users/jarkius/workspace/test-spawns] [to:test-matrix2] Connection stability test from test-spawns

### How to prevent
N/A

---

## Lesson: [msg:direct] [from:/Users/jarkius/workspace/test-spawns] [to:test-matrix2] Hello from test-spawns!
**Date**: 2026-01-23
**Category**: Insight
**Confidence**: [low]

### What happened
N/A

### What I learned
[msg:direct] [from:/Users/jarkius/workspace/test-spawns] [to:test-matrix2] Hello from test-spawns!

### How to prevent
N/A

---

## Lesson: [msg:direct] [from:/Users/jarkius/workspace/test-spawns] [to:evolve-and-excel] Test message from test-spawns - matrix communication check
**Date**: 2026-01-23
**Category**: Insight
**Confidence**: [low]

### What happened
N/A

### What I learned
[msg:direct] [from:/Users/jarkius/workspace/test-spawns] [to:evolve-and-excel] Test message from test-spawns - matrix communication check

### How to prevent
N/A

---

## Lesson: [msg:direct] [from:/Users/jarkius/workspace/test-spawns] [to:evolve-and-excel] Hello from test-spawns! Matrix communication test after fixes.
**Date**: 2026-01-23
**Category**: Insight
**Confidence**: [low]

### What happened
N/A

### What I learned
[msg:direct] [from:/Users/jarkius/workspace/test-spawns] [to:evolve-and-excel] Hello from test-spawns! Matrix communication test after fixes.

### How to prevent
N/A

---

## Lesson: [msg:direct] [from:/Users/jarkius/workspace/test-spawns] [to:evolve-and-excel] Hello from test-spawns! Testing matrix communication after recent fixes.
**Date**: 2026-01-23
**Category**: Insight
**Confidence**: [low]

### What happened
N/A

### What I learned
[msg:direct] [from:/Users/jarkius/workspace/test-spawns] [to:evolve-and-excel] Hello from test-spawns! Testing matrix communication after recent fixes.

### How to prevent
N/A

---

## Lesson: [msg:direct] [from:/Users/jarkius/workspace/test-spawns] [to:test-matrix2] Pushed 0e623b4: Per-matrix PID files (daemon-{id}.pid), respects daemon_dir from .matrix.json. Multiple matrices can now run daemons on same machine.
**Date**: 2026-01-23
**Category**: Insight
**Confidence**: [low]

### What happened
N/A

### What I learned
[msg:direct] [from:/Users/jarkius/workspace/test-spawns] [to:test-matrix2] Pushed 0e623b4: Per-matrix PID files (daemon-{id}.pid), respects daemon_dir from .matrix.json. Multiple matrices can now run daemons on same machine.

### How to prevent
N/A

---

## Lesson: [msg:broadcast] [from:/Users/jarkius/workspace/test-spawns] Testing message delivery via daemon
**Date**: 2026-01-23
**Category**: Insight
**Confidence**: [low]

### What happened
N/A

### What I learned
[msg:broadcast] [from:/Users/jarkius/workspace/test-spawns] Testing message delivery via daemon

### How to prevent
N/A

---

## Lesson: [msg:direct] [from:/Users/jarkius/workspace/test-spawns] [to:test-matrix2] Fixed: status.ts now reads matrix_id from .matrix.json. Pull d3c3a8a
**Date**: 2026-01-23
**Category**: Insight
**Confidence**: [low]

### What happened
N/A

### What I learned
[msg:direct] [from:/Users/jarkius/workspace/test-spawns] [to:test-matrix2] Fixed: status.ts now reads matrix_id from .matrix.json. Pull d3c3a8a

### How to prevent
N/A

---

## Lesson: [msg:broadcast] [from:/Users/jarkius/workspace/test-spawns] Matrix connection test from Opus
**Date**: 2026-01-23
**Category**: Insight
**Confidence**: [low]

### What happened
N/A

### What I learned
[msg:broadcast] [from:/Users/jarkius/workspace/test-spawns] Matrix connection test from Opus

### How to prevent
N/A

---

## Lesson: All CRUD functions properly handle github_repo for flexible sync targets
**Date**: 2026-01-22
**Category**: Insight
**Confidence**: [low]

### What happened
Win from session: All CRUD functions properly handle github_repo for flexible sync targets

### What I learned
All CRUD functions properly handle github_repo for flexible sync targets

### How to prevent
N/A

---

## Lesson: saveMatrixMessage return type needed to change to include sequenceNumber
**Date**: 2026-01-22
**Category**: Insight
**Confidence**: [low]

### What happened
Challenge from session: saveMatrixMessage return type needed to change to include sequenceNumber

### What I learned
saveMatrixMessage return type needed to change to include sequenceNumber

### How to prevent
N/A

---

## Lesson: Idempotent migrations should run outside conditional schema init block
**Date**: 2026-01-22
**Category**: Insight
**Confidence**: [low]

### What happened
Learning from session: Idempotent migrations should run outside conditional schema init block

### What I learned
Idempotent migrations should run outside conditional schema init block

### How to prevent
N/A

---

---

## Summary

### By Confidence

| Level | Count |
|-------|-------|
| medium | 15 |
| low | 43 |

### By Category

| Category | Count |
|----------|-------|
| insight | 30 |
| tooling | 7 |
| performance | 6 |
| testing | 5 |
| debugging | 4 |
| security | 3 |
| architecture | 2 |
| process | 1 |
